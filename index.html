<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ç‰©è‹±æ–‡å­¸ç¿’åœ’åœ° (è«å…§é¢¨æ ¼)</title>
    <!-- è¼‰å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è¨­ç½® Inter å­—é«” */
        body {
            font-family: 'Inter', sans-serif;
            /* è«å…§é¢¨æ ¼çš„æŸ”å’ŒèƒŒæ™¯è‰² */
            background-color: #fcf8f0; 
        }

        /* è«å…§é¢¨æ ¼çš„æŒ‰éˆ•å’Œå¡ç‰‡åŸºç¤æ¨£å¼ */
        .monet-button {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(105, 129, 142, 0.1), 0 2px 4px -2px rgba(105, 129, 142, 0.06);
            /* æŸ”å’Œçš„è—ç¶ è‰²èª¿ */
            background-color: #a2d2ff; 
            color: #1e3a8a;
            border: 2px solid #81b2e6;
        }

        .monet-button:hover {
            /* æ‡¸åœæ™‚é¡è‰²åŠ æ·±ï¼Œæ¨¡æ“¬å…‰å½±è®ŠåŒ– */
            background-color: #81b2e6;
            color: #ffffff;
            box-shadow: 0 6px 15px -3px rgba(105, 129, 142, 0.2), 0 4px 6px -4px rgba(105, 129, 142, 0.1);
        }
        
        .monet-card {
            background-color: #ffffff; /* ç™½è‰²ä½œç‚ºç•«å¸ƒ */
            border-radius: 1.5rem; /* æ›´åœ“æ½¤çš„é‚Šè§’ */
            box-shadow: 0 10px 20px rgba(105, 129, 142, 0.15); /* æŸ”å’Œçš„é™°å½± */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .monet-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(105, 129, 142, 0.25);
        }

        /* è¨˜æ†¶é…å°éŠæˆ²çš„å¡ç‰‡æ¨£å¼ */
        .memory-card {
            aspect-ratio: 1 / 1;
            transform-style: preserve-3d;
            position: relative;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        .memory-card-inner {
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .memory-card.flipped .memory-card-inner {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1rem;
            border: 3px solid #81b2e6;
            font-weight: bold;
            font-size: 1.5rem;
        }

        /* å¡èƒŒ (æœªç¿»é–‹çš„ç‹€æ…‹) - è«å…§çš„è·èŠ±æ± ç¶  */
        .card-back {
            background-color: #b8e0d4; 
            color: #4a7a8f;
            transform: rotateY(0deg);
            font-size: 2rem;
        }
        
        /* å¡é¢ (ç¿»é–‹çš„ç‹€æ…‹) - æŸ”å’Œçš„é»ƒè‰²èª¿ */
        .card-front {
            background-color: #ffe8d6;
            color: #3b3b3b;
            transform: rotateY(180deg);
            padding: 0.5rem;
            line-height: 1.2;
        }
        
        /* åŒ¹é…æˆåŠŸçš„å¡ç‰‡ */
        .memory-card.matched .card-back {
            background-color: #e0f2f1; /* æˆåŠŸå¾Œè®Šæ·ºç¶ è‰² */
            opacity: 0.8;
            cursor: default;
        }

    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <!-- æ¨™é¡Œèˆ‡å°èˆª -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#3a5a40] tracking-tight">è«å…§èŠ±åœ’ï¼šå‹•ç‰©è‹±æ–‡å­¸ç¿’</h1>
            <p class="mt-2 text-xl text-[#62929e]">åœ¨å°è±¡æ´¾çš„æ°›åœä¸­æ¢ç´¢ 20 å€‹å‹•ç‰©å–®å­—ã€‚</p>
        </header>

        <nav class="flex justify-center space-x-4 mb-8">
            <button id="nav-learn" class="monet-button px-4 py-2 rounded-xl text-lg">å­¸ç¿’ä¾‹å¥</button>
            <button id="nav-quiz" class="monet-button px-4 py-2 rounded-xl text-lg">å•ç­”éŠæˆ²</button>
            <button id="nav-memory" class="monet-button px-4 py-2 rounded-xl text-lg">è¨˜æ†¶é…å°</button>
        </nav>

        <!-- ä¸»è¦å…§å®¹å€ -->
        <main id="app-content" class="min-h-[60vh] p-6 monet-card">
            <!-- å…§å®¹å°‡ç”± JavaScript å‹•æ…‹è¼‰å…¥ -->
        </main>

        <!-- èªéŸ³éŒ¯èª¤æˆ–ä¸æ”¯æŒçš„æç¤º -->
        <div id="status-message" class="fixed bottom-0 right-0 m-4 p-3 rounded-lg shadow-xl bg-red-100 text-red-700 hidden" role="alert">
            <p id="status-text"></p>
        </div>

    </div>

    <script>
        // 20 å€‹å‹•ç‰©è‹±æ–‡å–®å­—ã€ä¸­æ–‡ç¿»è­¯ã€Emoji å’Œä¾‹å¥
        const animals = [
            { en: 'Dog', zh: 'ç‹—', emoji: 'ğŸ•', example: 'The friendly {Dog} wagged its tail happily when I returned home.' },
            { en: 'Cat', zh: 'è²“', emoji: 'ğŸˆ', example: 'A sleek black {Cat} silently stalked a bird in the garden.' },
            { en: 'Tiger', zh: 'è€è™', emoji: 'ğŸ…', example: 'The massive striped {Tiger} is an apex predator in the jungle.' },
            { en: 'Lion', zh: 'ç…å­', emoji: 'ğŸ¦', example: 'The male {Lion} with its huge mane is called the king of the savanna.' },
            { en: 'Elephant', zh: 'å¤§è±¡', emoji: 'ğŸ˜', example: 'An enormous {Elephant} used its trunk to spray water on itself.' },
            { en: 'Monkey', zh: 'çŒ´å­', emoji: 'ğŸ’', example: 'A clever little {Monkey} stole a banana right out of my hand.' },
            { en: 'Bear', zh: 'ç†Š', emoji: 'ğŸ»', example: 'It is important to secure your food when camping in {Bear} country.' },
            { en: 'Fox', zh: 'ç‹ç‹¸', emoji: 'ğŸ¦Š', example: 'The sly {Fox} managed to escape the hunter by running into the dense woods.' },
            { en: 'Wolf', zh: 'ç‹¼', emoji: 'ğŸº', example: 'A pack of {Wolf} howled at the full moon high up in the mountains.' },
            { en: 'Deer', zh: 'é¹¿', emoji: 'ğŸ¦Œ', example: 'We watched a gentle {Deer} grazing quietly near the edge of the forest.' },
            { en: 'Rabbit', zh: 'å…”å­', emoji: 'ğŸ‡', example: 'The quick little {Rabbit} hopped away instantly when it heard a noise.' },
            { en: 'Squirrel', zh: 'æ¾é¼ ', emoji: 'ğŸ¿ï¸', example: 'The busy {Squirrel} buried nuts in the ground, preparing for winter.' },
            { en: 'Owl', zh: 'è²“é ­é·¹', emoji: 'ğŸ¦‰', example: 'An intelligent {Owl} watched silently from the branches of the ancient oak tree.' },
            { en: 'Eagle', zh: 'è€é·¹', emoji: 'ğŸ¦…', example: 'The majestic {Eagle} soared high above the cliffs, looking for prey.' },
            { en: 'Whale', zh: 'é¯¨é­š', emoji: 'ğŸ³', example: 'A huge blue {Whale} surfaced briefly, showing its massive size.' },
            { en: 'Dolphin', zh: 'æµ·è±š', emoji: 'ğŸ¬', example: 'The playful {Dolphin} swam alongside the boat, leaping out of the waves.' },
            { en: 'Penguin', zh: 'ä¼éµ', emoji: 'ğŸ§', example: 'A colony of {Penguin} waddled awkwardly across the ice to the sea.' },
            { en: 'Turtle', zh: 'çƒé¾œ', emoji: 'ğŸ¢', example: 'The slow-moving {Turtle} retracted its head into its shell when approached.' },
            { en: 'Frog', zh: 'é’è›™', emoji: 'ğŸ¸', example: 'A green {Frog} sat on a lily pad, making croaking sounds in the pond.' },
            { en: 'Snake', zh: 'è›‡', emoji: 'ğŸ', example: 'Be careful walking in the tall grass; a small {Snake} might be hiding there.' }
        ];

        // å…¨åŸŸè®Šæ•¸å’Œ DOM å…ƒç´ 
        const appContent = document.getElementById('app-content');
        const navButtons = {
            learn: document.getElementById('nav-learn'),
            quiz: document.getElementById('nav-quiz'),
            memory: document.getElementById('nav-memory'),
        };
        const statusMessage = document.getElementById('status-message');
        const statusText = document.getElementById('status-text');

        let currentView = 'learn';
        let synth = null;
        let defaultVoice = null;
        let quizState = {};
        let memoryGame = {};

        // --- èªéŸ³åˆæˆ (Text-to-Speech) ç›¸é—œå‡½æ•¸ ---

        function setupSpeech() {
            synth = window.speechSynthesis;
            if (!synth) {
                displayStatus('éŒ¯èª¤ï¼šæ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³åˆæˆåŠŸèƒ½ã€‚', 'error');
                return;
            }

            const setVoice = () => {
                const voices = synth.getVoices();
                // å˜—è©¦å°‹æ‰¾ä¸€å€‹è‹±æ–‡ (en-US, en-GB) èªéŸ³
                defaultVoice = voices.find(voice => voice.lang.startsWith('en')) || voices[0];
            };
            
            // èªéŸ³åˆ—è¡¨å¯èƒ½éœ€è¦æ™‚é–“è¼‰å…¥
            if (synth.getVoices().length === 0) {
                synth.onvoiceschanged = setVoice;
            } else {
                setVoice();
            }
        }

        function speakText(text, lang = 'en-US') {
            if (!synth || synth.speaking) {
                // å¦‚æœæ­£åœ¨èªªè©±ï¼Œå‰‡å–æ¶ˆç•¶å‰èªéŸ³
                if (synth.speaking) synth.cancel();
            }

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            
            if (lang.startsWith('en') && defaultVoice) {
                utterance.voice = defaultVoice;
            } else if (lang.startsWith('zh')) {
                // å˜—è©¦å°‹æ‰¾ä¸€å€‹ä¸­æ–‡èªéŸ³
                const chineseVoice = synth.getVoices().find(voice => voice.lang.startsWith('zh')) || defaultVoice;
                if (chineseVoice) utterance.voice = chineseVoice;
            }

            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            
            synth.speak(utterance);
        }

        function displayStatus(message, type = 'info') {
            statusText.textContent = message;
            statusMessage.classList.remove('hidden', 'bg-red-100', 'text-red-700', 'bg-green-100', 'text-green-700');
            
            if (type === 'error') {
                 statusMessage.classList.add('bg-red-100', 'text-red-700');
            } else if (type === 'success') {
                 statusMessage.classList.add('bg-green-100', 'text-green-700');
            } else {
                 statusMessage.classList.add('bg-blue-100', 'text-blue-700');
            }

            statusMessage.classList.remove('hidden');
            setTimeout(() => {
                statusMessage.classList.add('hidden');
            }, 3000); 
        }

        // --- è¼”åŠ©å‡½æ•¸ ---

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- å­¸ç¿’ä¾‹å¥æ¨¡çµ„ ---
        let currentLearnIndex = 0;

        function renderLearnModule() {
            currentView = 'learn';
            const animal = animals[currentLearnIndex];
            
            // æ›¿æ›ä¾‹å¥ä¸­çš„å–®å­—ä¸¦å¼·èª¿
            const highlightedExample = animal.example.replace(`{${animal.en}}`, 
                `<span class="text-[#81b2e6] font-bold text-xl">${animal.en}</span>`);

            appContent.innerHTML = `
                <h2 class="text-3xl font-bold text-[#4a7a8f] mb-6 text-center">å­¸ç¿’èˆ‡ä¾‹å¥</h2>
                
                <div class="max-w-xl mx-auto p-8 monet-card text-center space-y-4">
                    <div class="text-9xl mb-4">${animal.emoji}</div>
                    
                    <div class="flex justify-center items-center space-x-4">
                        <span class="text-4xl font-extrabold text-gray-800">${animal.en}</span>
                        <button onclick="speakText('${animal.en}')" class="text-[#3a5a40] hover:text-[#62929e] transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z" clip-rule="evenodd" />
                                <path fill-rule="evenodd" d="M8.25 6.25a.75.75 0 011.5 0v7.5a.75.75 0 01-1.5 0v-7.5z" clip-rule="evenodd" transform="rotate(-90 9 10)" />
                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-1 1v14a1 1 0 102 0V3a1 1 0 00-1-1z" clip-rule="evenodd" transform="rotate(-90 9 10)" />
                            </svg>
                            <span class="sr-only">æ’­æ”¾å–®å­—</span>
                        </button>
                    </div>
                    
                    <p class="text-xl text-[#3a5a40] mb-6">ä¸­æ–‡ï¼š${animal.zh}</p>

                    <hr class="border-t-2 border-[#f7eedd] my-6">

                    <h3 class="text-2xl font-semibold text-[#4a7a8f] mb-4">ä¾‹å¥ï¼š</h3>
                    <p class="text-lg text-gray-700 italic leading-relaxed">${highlightedExample}</p>

                    <button onclick="speakText('${animal.example.replace(`{${animal.en}}`, animal.en)}')" class="monet-button px-4 py-2 mt-4 rounded-lg text-md">
                        <span class="mr-2">è†è½ä¾‹å¥</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM6 11a1 1 0 000 2h8a1 1 0 100-2H6zM8 15a1 1 0 100 2h4a1 1 0 100-2H8z" />
                        </svg>
                    </button>
                </div>

                <div class="flex justify-center mt-8 space-x-4">
                    <button id="prev-btn" class="monet-button px-6 py-3 rounded-full text-lg ${currentLearnIndex === 0 ? 'opacity-50 cursor-not-allowed' : ''}">ä¸Šä¸€é </button>
                    <button id="next-btn" class="monet-button px-6 py-3 rounded-full text-lg ${currentLearnIndex === animals.length - 1 ? 'opacity-50 cursor-not-allowed' : ''}">ä¸‹ä¸€é </button>
                </div>
            `;

            document.getElementById('prev-btn').onclick = () => {
                if (currentLearnIndex > 0) {
                    currentLearnIndex--;
                    renderLearnModule();
                }
            };
            document.getElementById('next-btn').onclick = () => {
                if (currentLearnIndex < animals.length - 1) {
                    currentLearnIndex++;
                    renderLearnModule();
                }
            };
        }


        // --- å•ç­”éŠæˆ²æ¨¡çµ„ ---

        function generateQuiz() {
            // 1. é¸æ“‡æ­£ç¢ºç­”æ¡ˆ
            const correctAnimal = animals[Math.floor(Math.random() * animals.length)];
            
            // 2. é¸æ“‡ä¸‰å€‹éŒ¯èª¤ç­”æ¡ˆ
            let wrongOptions = animals.filter(a => a.en !== correctAnimal.en);
            wrongOptions = shuffle(wrongOptions).slice(0, 3);

            // 3. çµ„åˆæ‰€æœ‰é¸é …ä¸¦æ´—ç‰Œ
            let options = [...wrongOptions.map(a => a.en), correctAnimal.en];
            options = shuffle(options);
            
            // éš¨æ©Ÿé¸æ“‡å•é¡Œé¡å‹ (Emoji è½‰è‹±æ–‡ æˆ– ä¸­æ–‡è½‰è‹±æ–‡)
            const questionType = Math.random() > 0.5 ? 'emoji' : 'zh';
            
            let questionText, targetText, correctOption;

            if (questionType === 'emoji') {
                questionText = `é€™å€‹åœ–ç¤ºä»£è¡¨å“ªä¸€å€‹å‹•ç‰©ï¼Ÿ`;
                targetText = correctAnimal.emoji;
                correctOption = correctAnimal.en;
            } else { // zh
                questionText = `"${correctAnimal.zh}" çš„è‹±æ–‡å–®å­—æ˜¯ä»€éº¼ï¼Ÿ`;
                targetText = correctAnimal.zh;
                correctOption = correctAnimal.en;
            }

            quizState = {
                correctAnswer: correctOption,
                options: options,
                questionText: questionText,
                targetText: targetText,
                questionType: questionType,
                hasAnswered: false,
                feedback: ''
            };
            renderQuizModule();
        }

        function handleQuizAnswer(selectedAnswer) {
            if (quizState.hasAnswered) return;
            quizState.hasAnswered = true;
            
            if (selectedAnswer === quizState.correctAnswer) {
                quizState.feedback = 'ç­”å°äº†ï¼<span class="text-[#3a5a40]">Good job!</span>';
                speakText('Correct!', 'en-US');
            } else {
                quizState.feedback = `ç­”éŒ¯äº†ã€‚æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š<span class="text-red-700">${quizState.correctAnswer}</span>`;
                speakText('Wrong. The correct answer is ' + quizState.correctAnswer, 'en-US');
            }
            renderQuizModule();
        }

        function renderQuizModule() {
            currentView = 'quiz';
            if (!quizState.correctAnswer) {
                generateQuiz();
                return;
            }

            const optionsHtml = quizState.options.map(option => `
                <button 
                    onclick="handleQuizAnswer('${option}')"
                    class="monet-button text-2xl w-full py-4 px-6 rounded-xl hover:bg-[#81b2e6] hover:text-white transition-all duration-300 
                           ${quizState.hasAnswered ? 'opacity-60 cursor-default' : ''}
                           ${quizState.hasAnswered && option === quizState.correctAnswer ? 'bg-green-300 text-green-900 border-green-500 font-bold opacity-100' : ''}"
                >
                    ${option}
                </button>
            `).join('');

            appContent.innerHTML = `
                <h2 class="text-3xl font-bold text-[#4a7a8f] mb-8 text-center">å•ç­”éŠæˆ²ï¼šé¸æ“‡é¡Œ</h2>

                <div class="max-w-xl mx-auto p-8 monet-card text-center space-y-6">
                    <p class="text-xl text-[#3a5a40] font-semibold">${quizState.questionText}</p>
                    
                    <div class="text-7xl font-extrabold text-[#1e3a8a] py-4">
                        ${quizState.targetText}
                    </div>
                    
                    <div class="grid grid-cols-1 gap-4 mt-6">
                        ${optionsHtml}
                    </div>

                    ${quizState.hasAnswered ? `
                        <div class="mt-8 p-4 rounded-lg text-lg font-bold ${quizState.feedback.includes('ç­”å°') ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${quizState.feedback}
                        </div>
                        <button onclick="generateQuiz()" class="monet-button bg-[#f7eedd] text-[#3a5a40] border-[#3a5a40] px-6 py-3 rounded-full text-lg mt-4 hover:bg-[#ffe8d6]">
                            ä¸‹ä¸€é¡Œ
                        </button>
                    ` : ''}

                </div>
            `;
        }

        // --- è¨˜æ†¶é…å°éŠæˆ²æ¨¡çµ„ ---

        function initMemoryGame() {
            currentView = 'memory';
            memoryGame = {
                cards: [],
                flippedCards: [],
                matchesFound: 0,
                lockBoard: false
            };

            // å‰µå»ºé…å°å¡ç‰‡ (å–®å­—å’Œ Emoji)
            let cardPairs = [];
            animals.forEach(animal => {
                cardPairs.push({ id: animal.en, content: animal.en, type: 'word' });
                cardPairs.push({ id: animal.en, content: animal.emoji, type: 'emoji' });
            });
            
            // æ´—ç‰Œ
            memoryGame.cards = shuffle(cardPairs);
            renderMemoryModule();
        }

        function flipCard(cardElement, cardData) {
            if (memoryGame.lockBoard || cardElement.classList.contains('flipped') || cardElement.classList.contains('matched')) return;

            cardElement.classList.add('flipped');
            memoryGame.flippedCards.push({ element: cardElement, data: cardData });

            if (memoryGame.flippedCards.length === 2) {
                memoryGame.lockBoard = true;
                checkForMatch();
            }
        }

        function checkForMatch() {
            const [firstCard, secondCard] = memoryGame.flippedCards;
            const isMatch = firstCard.data.id === secondCard.data.id;

            if (isMatch) {
                handleMatch(firstCard.element, secondCard.element, firstCard.data.id);
            } else {
                handleMismatch(firstCard.element, secondCard.element);
            }
        }

        function handleMatch(card1, card2, word) {
            // åŒ¹é…æˆåŠŸ
            card1.classList.add('matched');
            card2.classList.add('matched');
            card1.onclick = null;
            card2.onclick = null;
            memoryGame.matchesFound++;
            memoryGame.lockBoard = false;
            memoryGame.flippedCards = [];
            speakText(word, 'en-US');

            if (memoryGame.matchesFound === animals.length) {
                setTimeout(() => {
                    displayStatus('æ­å–œï¼æ‚¨æˆåŠŸé…å°äº†æ‰€æœ‰å¡ç‰‡ï¼', 'success');
                    renderMemoryModule(); // é‡æ–°æ¸²æŸ“å‹åˆ©ç•«é¢æˆ–é–‹å§‹æ–°éŠæˆ²
                }, 1000);
            }
        }

        function handleMismatch(card1, card2) {
            // åŒ¹é…å¤±æ•—ï¼Œå»¶é²å¾Œç¿»å›
            setTimeout(() => {
                card1.classList.remove('flipped');
                card2.classList.remove('flipped');
                memoryGame.lockBoard = false;
                memoryGame.flippedCards = [];
            }, 1500);
        }

        function renderMemoryModule() {
            currentView = 'memory';

            if (memoryGame.matchesFound === animals.length) {
                 appContent.innerHTML = `
                    <h2 class="text-4xl font-extrabold text-[#3a5a40] mb-6 text-center">ğŸ‰ éŠæˆ²å‹åˆ©ï¼ ğŸ‰</h2>
                    <p class="text-xl text-[#62929e] mb-8 text-center">æ‚¨æˆåŠŸåœ°é…å°äº†æ‰€æœ‰ ${animals.length} çµ„å‹•ç‰©å–®å­—ï¼</p>
                    <div class="flex justify-center">
                        <button onclick="initMemoryGame()" class="monet-button bg-[#ffe8d6] text-[#3a5a40] border-[#3a5a40] px-8 py-4 rounded-full text-xl hover:bg-[#f7eedd]">
                            å†ç©ä¸€æ¬¡
                        </button>
                    </div>
                `;
                return;
            }

            const cardGridHtml = memoryGame.cards.map((card, index) => {
                return `
                    <div class="memory-card" data-index="${index}" onclick="handleMemoryClick(this, ${index})">
                        <div class="memory-card-inner">
                            <div class="card-face card-front ${card.type === 'emoji' ? 'text-5xl' : 'text-xl md:text-2xl'}">
                                ${card.content}
                            </div>
                            <div class="card-face card-back text-4xl">
                                ?
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            appContent.innerHTML = `
                <h2 class="text-3xl font-bold text-[#4a7a8f] mb-6 text-center">è¨˜æ†¶é…å°éŠæˆ²</h2>
                <p class="text-lg text-[#62929e] mb-6 text-center">ç›®æ¨™ï¼šå°‡å‹•ç‰©çš„è‹±æ–‡å–®å­—å’Œå°æ‡‰çš„ Emoji é…å°ã€‚</p>
                <div class="flex justify-center mb-4">
                     <div class="text-xl font-semibold text-[#3a5a40] mr-4">å·²é…å°ï¼š${memoryGame.matchesFound} / ${animals.length}</div>
                     <button onclick="initMemoryGame()" class="text-sm text-red-500 hover:text-red-700 transition-colors">é‡æ–°é–‹å§‹</button>
                </div>
                <div class="grid grid-cols-4 sm:grid-cols-5 md:grid-cols-8 gap-3 md:gap-4 max-w-4xl mx-auto">
                    ${cardGridHtml}
                </div>
            `;
        }

        function handleMemoryClick(element, index) {
            const cardData = memoryGame.cards[index];
            flipCard(element, cardData);
        }


        // --- è¦–åœ–æ§åˆ¶èˆ‡åˆå§‹åŒ– ---

        function setView(viewName) {
            // æ¸…é™¤æ‰€æœ‰æŒ‰éˆ•çš„æ¨£å¼
            Object.values(navButtons).forEach(btn => {
                btn.classList.remove('bg-[#81b2e6]', 'text-white');
                btn.classList.add('bg-[#a2d2ff]', 'text-[#1e3a8a]');
            });

            // è¨­å®šç•¶å‰æŒ‰éˆ•çš„æ¨£å¼
            navButtons[viewName].classList.remove('bg-[#a2d2ff]', 'text-[#1e3a8a]');
            navButtons[viewName].classList.add('bg-[#81b2e6]', 'text-white');
            
            // æ ¹æ“šè¦–åœ–åç¨±æ¸²æŸ“å°æ‡‰æ¨¡çµ„
            if (viewName === 'learn') {
                renderLearnModule();
            } else if (viewName === 'quiz') {
                generateQuiz();
            } else if (viewName === 'memory') {
                initMemoryGame();
            }
        }

        // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œ
        window.onload = () => {
            setupSpeech();

            // å°èˆªæŒ‰éˆ•äº‹ä»¶ç›£è½å™¨
            navButtons.learn.addEventListener('click', () => setView('learn'));
            navButtons.quiz.addEventListener('click', () => setView('quiz'));
            navButtons.memory.addEventListener('click', () => setView('memory'));

            // é è¨­è¼‰å…¥å­¸ç¿’æ¨¡çµ„
            setView('learn');
        };
    </script>
</body>
</html>
